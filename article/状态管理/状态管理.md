## 状态管理相关概念

状态管理是开发者对交互界面的一种抽象，每个交互单元都可以被看做是一个状态变化集合。

从用户角度看，交互单元包含的元素有

- 用户操作
- 界面变化

从开发者角度，交互单元包含的元素有

- 用户操作
- 界面变化
- 数据处理

开发者对交互单元进一步抽象，可以将界面的变化看作这个交互单元在不同状态下切换，而造成这种切换的，有两种可能

- 用户的操作
- 数据的变更

进行了这种抽象之后，开发者考虑可以将界面的不同状态进行统一管理，状态就是界面的本质属性，不同的界面跟相应状态绑定，想改变界面时候，只要改变相应状态就行了。这样，交互单元的变化流程为：交互/数据变更->状态改变->界面变化

了解了进行了状态管理的交互单元的变化流程后，我们可以知道

对于状态管理工具来说，状态管理的要素有

- 状态如何存储，状态管理工具一般会将状态统一存储
- 状态如何操作，即提供给应用程序什么样的api，让其操作状态
- 状态变化后，如何通知应用程序状态的改变，通常会需要一个响应函数定义状态变化时候应用程序需要做哪些操作

我们来看下两个主流状态管理工具是如何处理这些问题的

mobx

- 状态如何存储：状态统一存储在一个对象中，store
- 状态如何操作：可以直接对store中的数据进行操作，也可以用action进行操作
- 状态变化后，如何通知应用程序状态的改变：mobx是响应式的状态管理工具，使用```autorun```运行一下响应方法，即可以让响应方法在被监听的变量变化时候自动执行

redux

- 状态如何存储：状态统一存储在一个对象中，store
- 状态如何操作：action触发事件，reducer根据事件和当前状态确定状态如何变更，redux将动作和状态变化分离，用户需要定义action及reducer（触发某个action后，如何根据action及当前状态返回下一个状态）
- 状态变化后，如何通知应用程序状态的改变：redux给应用程序提供一个状态改变的事件监听，每当状态改变，就会执行响应函数

对于应用程序来说，状态管理的两个要素是

- 应用程序如何管理（维护状态，操作状态，监听状态改变）
- 状态如何和界面绑定

应用程序管理状态可以使用状态管理工具（redux、mobx等）

应用程序将状态和界面绑定即定义响应函数，监听状态管理工具的状态变化事件，修改界面。如果我们使用react，也可以使用状态管理工具提供的配套方案进行界面和状态的绑定（react-redux/mobx-react）


## 使用状态管理的应用程序的编程关键点

使用状态管理工具的编程主要包含3方面的操作：状态的维护、状态的操作、监听状态改变变化界面

### redux

- 状态的维护：createStore
- 状态的操作：定义action & reducer  触发 dispatch
- 监听状态改变变化界面
	- UI层获取状态数据：connect，定义UI组件，从容器组件->UI组件
	- 定义数据到UI的映射：mapStateToProps

### mobx

- 状态的维护：class Store
- 状态的操作：直接修改状态 / 使用action
- 监听状态改变变化界面
	- UI层获取状态数据：@inject
	- 定义数据到UI的映射：@observer

## 状态管理方式

- redux
	- 操作与状态变化分离（状态机）
- mobx
	- 双向绑定

// TODO：mobx双向绑定 使用mobx实际开发中的代码组织